<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nihongo Flashcards - Categories</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Load Google Fonts for a pleasant UI and Japanese support -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Noto+Sans+JP:wght@400;700&display=swap" rel="stylesheet">
    <style>
        /* Custom styles for the flashcard */
        body {
            font-family: 'Inter', sans-serif;
            min-height: 100vh;
            background-color: #f7f3f0; /* Light parchment background */
            transition: background-color 0.3s ease;
        }
        /* Utility class to apply Japanese font (used dynamically in JS) */
        .card-font-jp {
            font-family: 'Noto Sans JP', sans-serif;
            line-height: 1.5;
        }
        .card-container {
            perspective: 1000px;
        }
        .flashcard {
            transition: transform 0.6s;
            transform-style: preserve-3d;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
            cursor: pointer;
            min-height: 350px; /* Ensure good touch target size */
        }
        /* State for when the card is flipped */
        .flipped {
            transform: rotateY(180deg);
        }
        .card-face {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 1.5rem; /* Large rounded corners */
            padding: 2rem;
            text-align: center;
        }
        .card-front {
            background-color: white;
            color: #2c3e50;
        }
        .card-back {
            background-color: #2c3e50;
            color: white;
            transform: rotateY(180deg);
        }
        /* Style for category buttons */
        .category-btn {
            @apply w-full md:w-56 p-6 rounded-2xl text-2xl font-bold transition duration-200 transform hover:scale-[1.03] active:scale-100 shadow-lg cursor-pointer;
        }
    </style>
</head>
<body class="p-4 flex flex-col items-center justify-center">

    <div class="max-w-xl w-full mx-auto mt-8">
        <h1 class="text-4xl font-bold text-center text-gray-800 mb-8">日本語のフラッシュカード</h1>

        <!-- 1. CATEGORY SELECTION VIEW (Landing Page) -->
        <div id="landing-page" class="space-y-4">
            <h2 class="text-2xl font-semibold text-center text-gray-700 mb-6">Select a Category to Practice:</h2>
            <div id="category-buttons" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <!-- Buttons defined here -->
                <button data-category="expression" class="category-btn bg-blue-500 text-white hover:bg-blue-600">Expressions</button>
                <button data-category="noun" class="category-btn bg-green-500 text-white hover:bg-green-600">Nouns</button>
                <button data-category="adjective" class="category-btn bg-yellow-500 text-gray-900 hover:bg-yellow-600">Adjectives</button>
                <button data-category="verb" class="category-btn bg-red-500 text-white hover:bg-red-600">Verbs</button>
                <button data-category="kanji" class="category-btn bg-indigo-500 text-white hover:bg-indigo-600">Kanji</button>
                <!-- NEW TRAVEL CATEGORY -->
                <button data-category="travel" class="category-btn bg-purple-500 text-white hover:bg-purple-600">Travel</button>
            </div>
        </div>

        <!-- 2. FLASHCARD PRACTICE VIEW -->
        <div id="practice-view" class="hidden">
            <p id="current-category-label" class="text-center text-xl font-medium text-gray-600 mb-4"></p>
            
            <!-- Flashcard Container -->
            <div id="card-container" class="card-container w-full h-auto">
                <div id="flashcard" class="flashcard bg-white rounded-3xl shadow-xl w-full">
                    <!-- Card Front: Default Japanese Word, but dynamic based on category -->
                    <div id="card-front" class="card-face card-front">
                        <p id="japanese-word" class="text-6xl font-bold transition duration-300 transform scale-100 card-font-jp">
                            Loading...
                        </p>
                    </div>

                    <!-- Card Back: Default English Meaning, but dynamic based on category -->
                    <div id="card-back" class="card-face card-back">
                        <p id="english-meaning" class="text-3xl font-semibold px-4">
                            Translation will appear here.
                        </p>
                    </div>
                </div>
            </div>

            <!-- Action Buttons -->
            <div class="mt-8 flex justify-center space-x-4">
                <button id="next-button" class="px-6 py-3 bg-indigo-600 text-white font-semibold rounded-full shadow-lg hover:bg-indigo-700 transition duration-300 ease-in-out transform hover:scale-105 active:scale-100 focus:outline-none focus:ring-4 focus:ring-indigo-300">
                    Next Word
                </button>
                <button id="return-button" class="px-6 py-3 bg-gray-300 text-gray-800 font-semibold rounded-full shadow-lg hover:bg-gray-400 transition duration-300 ease-in-out">
                    Return to Categories
                </button>
            </div>
        </div>

    </div>

    <!-- JavaScript for Data and Logic -->
    <script>
        // --- 1. VOCABULARY DATA (Categorized Spreadsheet Equivalent) ---
        // EDIT THIS OBJECT to add, remove, or modify your flashcards.
        // The 'travel' category now requires a 'romaji' field.
        const allVocabulary = {
            "expression": [
                { japanese: "こんにちは", english: "Hello / Good afternoon" },
                { japanese: "ありがとう", english: "Thank you" },
                { japanese: "さようなら", english: "Goodbye" },
                { japanese: "すみません", english: "Excuse me / I'm sorry" },
                { japanese: "いただきます", english: "I humbly receive (before eating)" },
                { japanese: "がんばって", english: "Do your best / Good luck" },
            ],
            "noun": [
                { japanese: "猫 (ねこ)", english: "Cat" },
                { japanese: "犬 (いぬ)", english: "Dog" },
                { japanese: "本 (ほん)", english: "Book" },
                { japanese: "車 (くるま)", english: "Car" },
                { japanese: "水 (みず)", english: "Water" },
            ],
            "adjective": [
                { japanese: "おいしい", english: "Delicious" },
                { japanese: "きれい", english: "Pretty / Clean" },
                { japanese: "暑い (あつい)", english: "Hot (weather)" },
                { japanese: "寒い (さむい)", english: "Cold (weather)" },
                { japanese: "高い (たかい)", english: "Expensive / Tall" },
            ],
            "verb": [
                { japanese: "食べる (たべる)", english: "To eat" },
                { japanese: "飲む (のむ)", english: "To drink" },
                { japanese: "走る (はしる)", english: "To run" },
                { japanese: "見る (みる)", english: "To see / watch" },
                { japanese: "聞く (きく)", english: "To hear / listen" },
            ],
            "kanji": [
                { japanese: "一", english: "One" },
                { japanese: "二", english: "Two" },
                { japanese: "人", english: "Person" },
                { japanese: "山", english: "Mountain" },
                { japanese: "川", english: "River" },
            ],
            // NEW TRAVEL CATEGORY (English on front, Japanese/Romaji on back)
            "travel": [
                { japanese: "切符 (きっぷ)", english: "Ticket", romaji: "kippu" },
                { japanese: "ホテル", english: "Hotel", romaji: "hoteru" },
                { japanese: "空港 (くうこう)", english: "Airport", romaji: "kūkō" },
                { japanese: "駅 (えき)", english: "Train Station", romaji: "eki" },
                { japanese: "道 (みち)", english: "Road / Way", romaji: "michi" },
                { japanese: "両替 (りょうがえ)", english: "Money Exchange", romaji: "ryōgae" },
            ]
        };
        // ----------------------------------------------------

        // --- 2. DOM Elements and State ---
        const landingPage = document.getElementById('landing-page');
        const practiceView = document.getElementById('practice-view');
        const categoryButtonsContainer = document.getElementById('category-buttons');
        const currentCategoryLabel = document.getElementById('current-category-label');
        const flashcard = document.getElementById('flashcard');
        const japaneseWordEl = document.getElementById('japanese-word');
        const englishMeaningEl = document.getElementById('english-meaning');
        const nextButton = document.getElementById('next-button');
        const returnButton = document.getElementById('return-button');

        let currentDeck = []; // The vocabulary array currently being practiced
        let currentWordIndex = -1;
        let isFlipped = false;
        let isReversedDeck = false; // NEW: Flag to track if the deck should be English-first

        // --- 3. View Management Functions ---

        /**
         * Switches the display between the landing page and the practice view.
         * @param {string} viewName - 'landing' or 'practice'
         */
        function showView(viewName) {
            if (viewName === 'landing') {
                landingPage.classList.remove('hidden');
                practiceView.classList.add('hidden');
            } else if (viewName === 'practice') {
                landingPage.classList.add('hidden');
                practiceView.classList.remove('hidden');
            }
        }

        /**
         * Starts the flashcard practice with a specific category.
         * @param {string} category - The key of the vocabulary category.
         */
        function startPractice(category) {
            const deck = allVocabulary[category];
            if (!deck || deck.length === 0) {
                currentCategoryLabel.textContent = `No words found for '${category}'!`;
                return;
            }

            currentDeck = deck;
            // Set the reversal flag for the 'travel' category
            isReversedDeck = (category === 'travel'); 
            
            currentCategoryLabel.textContent = `Practicing: ${category.charAt(0).toUpperCase() + category.slice(1)}`;
            showView('practice');
            loadNewWord();
        }


        // --- 4. Flashcard Logic Functions ---

        /**
         * Selects a new random word from the current deck and updates the display.
         */
        function loadNewWord() {
            // Reset flip state and rotation
            flashcard.classList.remove('flipped');
            isFlipped = false;
            
            if (currentDeck.length === 0) {
                japaneseWordEl.textContent = "Error: Deck is empty.";
                englishMeaningEl.textContent = "Please return to categories.";
                return;
            }

            // Generate a random index, ensuring it's not the same as the current word if possible
            let newIndex;
            do {
                newIndex = Math.floor(Math.random() * currentDeck.length);
            } while (newIndex === currentWordIndex && currentDeck.length > 1);

            currentWordIndex = newIndex;
            const word = currentDeck[currentWordIndex];

            // Reset element styles before updating content
            englishMeaningEl.innerHTML = '';
            englishMeaningEl.classList.remove('text-xl');
            englishMeaningEl.classList.add('text-3xl'); // Default size for the back

            // Update content based on deck type
            if (isReversedDeck) {
                // TRAVEL Deck: English on front, Japanese/Romaji on back
                
                // Front: English (no JP font needed)
                japaneseWordEl.textContent = word.english;
                japaneseWordEl.classList.remove('card-font-jp');
                
                // Back: Japanese + Romaji (formatted)
                englishMeaningEl.innerHTML = `
                    <span class="text-5xl font-bold block mb-2 card-font-jp">${word.japanese}</span>
                    <span class="text-xl font-light opacity-80 block">${word.romaji}</span>
                `;
                // Remove the default text size for the custom spans to take effect
                englishMeaningEl.classList.remove('text-3xl');

            } else {
                // STANDARD Decks: Japanese on front, English on back
                
                // Front: Japanese (needs JP font)
                japaneseWordEl.textContent = word.japanese;
                japaneseWordEl.classList.add('card-font-jp');
                
                // Back: English (plain text)
                englishMeaningEl.textContent = word.english;
            }
        }

        /**
         * Flips the flashcard to show the hidden meaning.
         */
        function flipCard() {
            // Only flip if we have a word loaded
            if (currentDeck.length > 0) {
                isFlipped = !isFlipped;
                if (isFlipped) {
                    flashcard.classList.add('flipped');
                } else {
                    flashcard.classList.remove('flipped');
                }
            }
        }

        // --- 5. Event Listeners ---

        // Listener for category buttons on the landing page
        categoryButtonsContainer.addEventListener('click', (event) => {
            const category = event.target.dataset.category;
            if (category) {
                startPractice(category);
            }
        });

        // Listener for tapping/clicking the card to flip it
        flashcard.addEventListener('click', flipCard);

        // Listener for the next button to load a new word
        nextButton.addEventListener('click', (e) => {
            e.stopPropagation(); // Prevent the click from flipping the card immediately
            loadNewWord();
        });

        // Listener for the "Return to Categories" button
        returnButton.addEventListener('click', () => {
            // Reset practice state
            currentDeck = [];
            currentWordIndex = -1;
            isFlipped = false;
            isReversedDeck = false;
            showView('landing');
        });

        // --- 6. Initialization ---
        document.addEventListener('DOMContentLoaded', () => {
            // Start by showing the landing page
            showView('landing');
        });

    </script>
</body>
</html>
